<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>History â€” Mastermind Bet</title>
<style>
  body{margin:0;background:#0b0f17;color:#eaf2ff;font:14px system-ui,Segoe UI,Roboto}
  header{display:flex;gap:12px;padding:12px;background:#111a2a;border-bottom:1px solid #1a253b}
  a{color:#cfe0ff;text-decoration:none;background:#18233a;border:1px solid #243353;padding:6px 10px;border-radius:999px}
  .wrap{padding:16px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px;border-bottom:1px solid #1a253b;text-align:left}
  th{color:#9eb5e4}
  .won{color:#06d6a0;font-weight:700}
  .lost{color:#ef476f;font-weight:700}
</style>
</head>
<body>
<header>
  <a href="/pos">POS</a><a href="/virtual">Virtual</a><a href="/admin">Admin</a>
  <div style="margin-left:auto">History</div>
</header>

<div class="wrap">
  <table id="tbl"><thead>
    <tr><th>ID</th><th>Agent</th><th>Stake</th><th>Potential</th><th>Status</th><th>Created</th></tr>
  </thead><tbody></tbody></table>
</div>

<script>
async function load(){
  const r = await fetch('/api/tickets?limit=100'); const list = await r.json();
  document.querySelector('#tbl tbody').innerHTML = list.map(t =>
    `<tr>
      <td>${t.id}</td><td>${t.agent_code||'-'}</td>
      <td>${(t.stake_kes||0).toFixed(2)}</td>
      <td>${(t.potential_kes||0).toFixed(2)}</td>
      <td class="${t.status}">${t.status}</td>
      <td>${new Date(t.created_at).toLocaleString()}</td>
    </tr>`
  ).join('');
}
load();
setInterval(load, 5000); // refresh
</script>
</body>
</html>
